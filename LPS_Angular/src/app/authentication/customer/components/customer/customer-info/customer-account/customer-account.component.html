<div class='accordion' id='accordion-loan-limit'>
    <div class='card'>
        <div class="card-header alert-danger collapsed hvr-underline-from-left" id="headingOne" data-toggle="collapse"
            data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            <div class='row justify-content-between'>
                <div class='col-4'>
                    <h4>Loan Limit</h4>
                </div>
                <div class='col-1 text-right'>
                    <i class="heading-indicator icon fa fa-angle-down fa-2x"></i>
                </div>
            </div>
        </div>
        <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion-loan-limit">
            <div class='card-body' [ngClass]="{'text-center': loanlimitCount == 0}">
                <div class="overlay" *ngIf='!displayLoanLimits'>
                    <div class="m-loader mr-4">
                        <svg class="m-circular" viewBox="25 25 50 50">
                            <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4"
                                stroke-miterlimit="10" />
                        </svg>
                    </div>
                    <h3 class="l-text">Loading</h3>
                </div>
                <ul class="nav nav-tabs" id="loanlimit-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="executive-tab" data-toggle="tab" href="#executiveTab" role="tab"
                            aria-controls="executiveTab" aria-selected="false">Executive View</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="original-tab" data-toggle="tab" href="#originalTab" role="tab"
                            aria-controls="originalTab" aria-selected="false">Original View</a>
                    </li>
                </ul>
                <div class="tab-content" id="loanlimit-tab-content">
                    <!-- Loan limit executive view -->
                    <div class="tab-pane fade show active" id="executiveTab" role="tabpanel"
                        aria-labelledby="executiveTab">
                        <div class='row'>
                            <div class='col-md-12'>
                                <!-- Loan limit filter and pagination -->
                                <div class='row align-items-end'>
                                    <div class='col-md-4 col-sm-12'>
                                        <form class='form-inline'>
                                            <div class='form-group'>
                                                <label class='control-label' style='margin-right:10px;'>Product
                                                    Group</label>
                                                <select class="form-control custom-select-sm"
                                                    (change)="onLoanLimitAlcoChanged($event.target.value)"
                                                    #selLoanLimitGroup id='selLoanLimitGroup'>
                                                    <option *ngFor='let product of loanLimitAlco'>
                                                        {{product}}
                                                    </option>
                                                </select>
                                            </div>
                                        </form>
                                    </div>
                                    <div class='col-md-8 col-sm-12'>
                                        <div class='row'>
                                            <div class='col-md-12'>
                                                <span
                                                    class="badge badge-pill badge-primary float-right">{{loanlimitCount}}
                                                    entries</span> </div>
                                        </div>
                                        <div class='row'>
                                            <div class='col-md-12'>
                                                <pagination class='float-right pagination-sm'
                                                    [itemsPerPage]="itemsPerPage" [totalItems]="loanCount"
                                                    [rotate]="false" [maxSize]="maxPageSize"
                                                    (pageChanged)="pageLoanlimitChanged($event, selLoanLimitGroup)"
                                                    [boundaryLinks]="true">
                                                </pagination>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <span *ngIf='loanlimitCount == 0' class='badge badge-pill badge-secondary mt-1'>Customer
                                    has no
                                    Loan Limit</span>
                                <div class='table-responsive' *ngIf='loanlimitCount > 0'>
                                    <table class='table table-bordered table-hover table-striped table-loan'>
                                        <thead class='text-center'>
                                            <tr>
                                                <th class='text-middle loanlimit-header'
                                                    (click)="sortLoanLimit('LIMIT_NO')">
                                                    <div>Limit No (AFCPNo)<span class='sorting'><i
                                                                class="fa fa-sort"></i></span></div>
                                                </th>
                                                <th class='text-middle loanlimit-header'
                                                    (click)="sortLoanLimit('ALL_PRODUCT_ALCO')">
                                                    <div>Product<span class='sorting'><i class="fa fa-sort"></i></span>
                                                    </div>
                                                </th>
                                                <th class='text-middle loanlimit-header'
                                                    (click)="sortLoanLimit('TOTAL_LIMIT')">
                                                    <div>Litmit<span class='sorting'><i class="fa fa-sort"></i></span>
                                                    </div>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor='let loan of displayLoanLimits'>
                                                <td>{{loan.LIMIT_NO}}</td>
                                                <td>{{loan.ALL_PRODUCT_ALCO}}</td>
                                                <td class='text-right'>{{loan.TOTAL_LIMIT | number : '1.2-2'}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Loan limit original view -->
                    <div class="tab-pane fade" id="originalTab" role="tabpanel" aria-labelledby="originalTab">
                        <div class='table-responsive' *ngIf='loanLimitDetails?.length > 0'>
                            <table class="table table-bordered table-hover">
                                <thead class='text-center cursor-pointer'
                                    style='background-color: #009688;color: whitesmoke;'>
                                    <tr class='text-center'>
                                        <th scope="col" style="font-size:14px">AFOFFR</th>
                                        <th scope="col" style="font-size:14px">AFAPNO</th>
                                        <th scope="col" style="font-size:14px">AFFCDE</th>
                                        <th scope="col" style="font-size:14px">AFSEQ</th>
                                        <th scope="col" style='font-size:14px'>AFLEVL</th>
                                        <th scope="col" style="font-size:14px">AFLTYP</th>
                                        <th scope="col" style="font-size:14px">AFCPNO</th>
                                        <th scope="col" style="font-size:14px">AFCUR</th>
                                        <th scope="col" style="font-size:14px">AFFAMT</th>
                                    </tr>
                                </thead>
                                <tbody class='text-left'>
                                    <ng-container *ngFor='let lv0 of loanLimitDetails'>
                                        <tr class='cursor-pointer' (click)="lv0.expanded = !lv0.expanded"
                                            style='background-color:mintcream;'>
                                            <td style='width:100px;'>
                                                <i *ngIf="lv0.children && !lv0.expanded"
                                                    class="fa fa-plus-square text-primary mr-1"></i>
                                                <i *ngIf="lv0.children && lv0.expanded"
                                                    class="fa fa-minus-square text-danger mr-1"></i>
                                                <span [ngClass]="{'pl-3': !lv0.children}">{{lv0.AFOFFR}}</span></td>
                                            <td>{{lv0.AFAPNO}}</td>
                                            <td class='text-center'>{{lv0.AFFCDE}}</td>
                                            <td class='text-right'>{{lv0.AFSEQ}}</td>
                                            <td class='text-right'>{{lv0.AFLEVL}}</td>
                                            <td class='text-center'>{{lv0.AFLTYP}}</td>
                                            <td>{{lv0.AFCPNO}}</td>
                                            <td class='text-center'>{{lv0.AFCUR}}</td>
                                            <td class='text-right'>{{lv0.AFFAMT | number : "1.2-2"}}</td>
                                        </tr>
                                        <!-- level 1 -->
                                        <ng-container *ngIf="lv0.expanded && lv0.children">
                                            <ng-container *ngFor='let lv1 of lv0.children'>
                                                <tr class='cursor-pointer' (click)="lv1.expanded = !lv1.expanded">
                                                    <td class='pl-4 border-0' style='width:100px;'>
                                                        <i *ngIf="lv1.children && !lv1.expanded"
                                                            class="fa fa-plus-square text-primary mr-1"></i>
                                                        <i *ngIf="lv1.children && lv1.expanded"
                                                            class="fa fa-minus-square text-danger mr-1"></i>
                                                        <span [ngClass]="{'pl-3': !lv1.children}">Level1</span></td>
                                                    <td class='border-0'>{{lv1.AFAPNO}}</td>
                                                    <td class='border-0 text-center'>{{lv1.AFFCDE}}</td>
                                                    <td class='text-right border-0'>{{lv1.AFSEQ}}</td>
                                                    <td class='text-right border-0'>{{lv1.AFLEVL}}</td>
                                                    <td class='border-0 text-center'>{{lv1.AFLTYP}}</td>
                                                    <td class='border-0'>{{lv1.AFCPNO}}</td>
                                                    <td class='border-0 text-center'>{{lv1.AFCUR}}</td>
                                                    <td class='text-right border-0'>{{lv1.AFFAMT | number : "1.2-2"}}
                                                    </td>
                                                </tr>

                                                <!-- level 2 -->
                                                <ng-container *ngIf="lv0.expanded && lv1.expanded && lv1.children">
                                                    <tr *ngFor='let lv2 of lv1.children'>
                                                        <td class='pl-5 border-0' style='width:100px;'>Level2</td>
                                                        <td class='border-0'>{{lv2.AFAPNO}}</td>
                                                        <td class='border-0 text-center'>{{lv2.AFFCDE}}</td>
                                                        <td class='text-right border-0'>{{lv2.AFSEQ}}</td>
                                                        <td class='text-right border-0'>{{lv2.AFLEVL}}</td>
                                                        <td class='border-0 text-center'>{{lv2.AFLTYP}}</td>
                                                        <td class='border-0'>{{lv2.AFCPNO}}</td>
                                                        <td class='border-0 text-center'>{{lv2.AFCUR}}</td>
                                                        <td class='text-right border-0'>
                                                            {{lv2.AFFAMT | number : "1.2-2"}}</td>
                                                    </tr>
                                                </ng-container>
                                            </ng-container>
                                        </ng-container>
                                        <!-- <ng-container *ngIf="lv0.expanded && lv0.children">
                                            <tr class='cursor-pointer' (click)="lv0.children.expanded = !lv0.children.expanded">
                                                <td class='pl-4 border-0' style='width:100px;'>
                                                    <i *ngIf="lv0.children.children && !lv0.children.expanded"
                                                        class="fa fa-plus-square text-primary mr-1"></i>
                                                    <i *ngIf="lv0.children.children && lv0.children.expanded"
                                                        class="fa fa-minus-square text-danger mr-1"></i>
                                                    <span [ngClass]="{'pl-3': !lv0.children.children}">Level1</span></td>
                                                <td class='border-0'>{{lv0.children.AFAPNO}}</td>
                                                <td class='border-0 text-center'>{{lv0.children.AFFCDE}}</td>
                                                <td class='text-right border-0'>{{lv0.children.AFSEQ}}</td>
                                                <td class='text-right border-0'>{{lv0.children.AFLEVL}}</td>
                                                <td class='border-0 text-center'>{{lv0.children.AFLTYP}}</td>
                                                <td class='border-0'>{{lv0.children.AFCPNO}}</td>
                                                <td class='border-0 text-center'>{{lv0.children.AFCUR}}</td>
                                                <td class='text-right border-0'>{{lv0.children.AFFAMT | number : "1.2-2"}}</td>
                                            </tr>
                                        </ng-container> -->

                                        <!-- level 2 -->
                                        <!-- <ng-container *ngIf="lv0.expanded && lv0.children.expanded && lv0.children.children">
                                            <tr>
                                                <td class='pl-5 border-0' style='width:100px;'>Level2</td>
                                                <td class='border-0'>{{lv0.children.children.AFAPNO}}</td>
                                                <td class='border-0 text-center'>{{lv0.children.children.AFFCDE}}</td>
                                                <td class='text-right border-0'>{{lv0.children.children.AFSEQ}}</td>
                                                <td class='text-right border-0'>{{lv0.children.children.AFLEVL}}</td>
                                                <td class='border-0 text-center'>{{lv0.children.children.AFLTYP}}</td>
                                                <td class='border-0'>{{lv0.children.children.AFCPNO}}</td>
                                                <td class='border-0 text-center'>{{lv0.children.children.AFCUR}}</td>
                                                <td class='text-right border-0'>{{lv0.children.child.AFFAMT | number : "1.2-2"}}</td>
                                            </tr>
                                        </ng-container> -->
                                    </ng-container>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- </div> -->
    </div>
</div>
<!-- <hr> -->
<br>
<!-- Loan account table -->
<div class='accordion' id='accordion-loan'>
    <div class='card'>
        <div class="card-header alert-success collapsed hvr-underline-from-left" id="headingTwo" data-toggle="collapse"
            data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
            <!-- <h4>Loan Account</h4> -->
            <div class='row justify-content-between'>
                <div class='col-4'>
                    <h4>Loan Account</h4>
                </div>
                <div class='col-1 text-right'>
                    <i class="heading-indicator icon fa fa-angle-down fa-2x"></i>
                </div>
            </div>
        </div>
        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion-loan">
            <div class="card-body" [ngClass]="{'text-center': loanCount == 0}">
                <div class="overlay" *ngIf='!displayLoans'>
                    <div class="m-loader mr-4">
                        <svg class="m-circular" viewBox="25 25 50 50">
                            <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4"
                                stroke-miterlimit="10" />
                        </svg>
                    </div>
                    <h3 class="l-text">Loading</h3>
                </div>
                <div class='row'>
                    <div class='col-md-12'>
                        <!-- Loan account filter and pagination -->
                        <div class='row align-items-end'>
                            <div class='col-md-4 col-sm-12'>
                                <form class='form-inline'>
                                    <div class='form-group'>
                                        <label class='control-label' style='margin-right:10px;'>Product
                                            Group</label>
                                        <select class="form-control custom-select-sm"
                                            (change)="onLoanGroupChanged($event.target.value)" #selLoanGroup
                                            id='selLoanGroup'>
                                            <option *ngFor='let product of loanProducts'>
                                                {{product}}
                                            </option>
                                        </select>
                                    </div>
                                </form>
                            </div>
                            <div class='col-md-8 col-sm-12'>
                                <div class='row'>
                                    <div class='col-md-12'>
                                        <span class="badge badge-pill badge-primary float-right">{{loanCount}}
                                            entries</span> </div>
                                </div>
                                <div class='row'>
                                    <div class='col-md-12'>
                                        <pagination class='float-right pagination-sm' [itemsPerPage]="itemsPerPage"
                                            [totalItems]="loanCount" [rotate]="false" [maxSize]="maxPageSize"
                                            (pageChanged)="pageLoanChanged($event, selLoanGroup)"
                                            [boundaryLinks]="true">
                                        </pagination>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="overlay" *ngIf='!displayLoans'>
                            <div class="m-loader mr-4">
                                <svg class="m-circular" viewBox="25 25 50 50">
                                    <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4"
                                        stroke-miterlimit="10" />
                                </svg>
                            </div>
                            <h3 class="l-text">Loading</h3>
                        </div> -->
                        <span *ngIf='loanCount == 0' class='badge badge-pill badge-secondary mt-1'>Customer has no
                            Account</span>
                        <div class='table-responsive' *ngIf='loanCount > 0'>
                            <table class='table table-bordered table-hover table-striped table-loan'>
                                <thead class='text-center'>
                                    <th class='sorting-header flex-header' (click)="sortLoan('ACCTNO')">
                                        <div>Account
                                            No<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('ACTYPE')">
                                        <div>Actype<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('PRODUCT_CODE')">
                                        <div>Product Code<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('PRODUCT_GROUP')">
                                        <div>Product
                                            Group<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('LIMIT_NO')">
                                        <div>Limit No
                                            (AFCPNo)<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('OUTSTANDING')">
                                        <div>Outstanding<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('INT_RATE')">
                                        <div>Int Rate<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('ISSUE_DATE')">
                                        <div>Issue
                                            Date<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('MATURITY_DATE')">
                                        <div>Maturity
                                            Date<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('AGING')">
                                        <div>Aging<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='sorting-header flex-header' (click)="sortLoan('TDR_FLAG')">
                                        <div>TDR Flag<span class='sorting-icon'><i class="fa fa-sort"></i></span></div>
                                    </th>
                                    <th class='flex-header'>Relationship</th>
                                    <th class='flex-header'>Collateral</th>
                                    <th class='flex-header'>Others</th>
                                </thead>
                                <tbody>
                                    <tr *ngFor='let loan of displayLoans'>
                                        <td class='loan-td'>{{loan.ACCTNO}}</td>
                                        <td class='text-center loan-td'>{{loan.ACTYPE}}</td>
                                        <td class='text-center loan-td'>{{loan.PRODUCT_CODE}}</td>
                                        <td class='loan-td'>{{loan.PRODUCT_GROUP}}</td>
                                        <td class='loan-td'>{{loan.LIMIT_NO}}</td>
                                        <td class='text-right loan-td'>
                                            {{loan.OUTSTANDING | number : '1.2-2'}}
                                        </td>
                                        <td class='text-right loan-td'>
                                            {{loan.INT_RATE | number : '1.2-2'}}
                                        </td>
                                        <td class='loan-td'>{{loan.ISSUE_DATE}}</td>
                                        <td class='loan-td'>{{loan.MATURITY_DATE}}</td>
                                        <td class='text-right loan-td'>{{loan.AGING | number : '1.2-2'}}</td>
                                        <td class='text-center loan-td'>{{loan.TDR_FLAG}}</td>
                                        <td class='text-center view-product'>
                                            <button type='button' class='btn btn-success btn-view' data-toggle="modal"
                                                data-target="#accountRelModal" (click)='viewLoanRelation(loan.ACCTNO)'>
                                                <i class="icon fa fa-search fa-1x text-white"></i>
                                                View
                                            </button>
                                        </td>
                                        <td class='text-center view-product'><button type='button'
                                                class='btn btn-info btn-view' data-toggle='modal'
                                                data-target='#collateral2Modal' (click)='viewAccountCollateral(loan)'>
                                                <i class="icon fa fa-search fa-1x text-white"></i>
                                                View
                                            </button></td>
                                        <td class='text-center view-product'><button type='button'
                                                class='btn btn-secondary btn-view' (click)='viewOthers(loan)'>
                                                <i class="icon fa fa-search fa-1x text-white"></i>
                                                View
                                            </button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- <hr> -->
<br>
<!-- Deposit account table -->
<div class='accordion' id='accordion-deposit'>
    <div class='card'>
        <div class="card-header alert-info collapsed hvr-underline-from-left" id="headingThree" data-toggle="collapse"
            data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
            <!-- <h4>Deposit Account</h4> -->
            <div class='row justify-content-between'>
                <div class='col-4'>
                    <h4>Deposit Account</h4>
                </div>
                <div class='col-1 text-right'>
                    <i class="heading-indicator icon fa fa-angle-down fa-2x"></i>
                </div>
            </div>
        </div>
        <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion-deposit">
            <div class="card-body" [ngClass]="{'text-center': depositCount == 0}">
                <div class="overlay" *ngIf='!displayDeposits'>
                    <div class="m-loader mr-4">
                        <svg class="m-circular" viewBox="25 25 50 50">
                            <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4"
                                stroke-miterlimit="10" />
                        </svg>
                    </div>
                    <h3 class="l-text">Loading</h3>
                </div>
                <div class='row'>
                    <div class='col-md-12'>
                        <!-- Deposit account filter an pagination -->
                        <div class='row align-items-end'>
                            <div class='col-md-4 col-sm-12'>
                                <form class='form-inline'>
                                    <div class='form-group'>
                                        <label class='control-label' style='margin-right:10px;'>Product
                                            Group</label>
                                        <select id='selDepositGroup' #selDepositGroup
                                            class="form-control custom-select-sm"
                                            (change)="onDepositGroupChanged($event.target.value)">
                                            <option *ngFor='let product of depositProducts'>
                                                {{product}}
                                            </option>
                                        </select>
                                    </div>
                                </form>
                            </div>
                            <div class='col-md-8 col-sm-12'>
                                <div class='row'>
                                    <div class='col-md-12'>
                                        <span class="badge badge-pill badge-primary float-right">{{depositCount}}
                                            entries</span>
                                    </div>
                                </div>
                                <div class='row'>
                                    <div class='col-md-12'>
                                        <pagination class='float-right pagination-sm' [itemsPerPage]="itemsPerPage"
                                            [totalItems]="depositCount" [rotate]="false" [maxSize]="maxPageSize"
                                            (pageChanged)="pageDepositChanged($event, selDepositGroup)"
                                            [boundaryLinks]="true">
                                        </pagination>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="overlay" *ngIf='!displayDeposits'>
                            <div class="m-loader mr-4">
                                <svg class="m-circular" viewBox="25 25 50 50">
                                    <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4"
                                        stroke-miterlimit="10" />
                                </svg>
                            </div>
                            <h3 class="l-text">Loading</h3>
                        </div> -->
                        <span *ngIf='depositCount == 0' class='badge badge-pill badge-secondary mt-1'>Customer has no
                            Account</span>
                        <div class='table-responsive' *ngIf='depositCount > 0'>
                            <table class='table table-bordered table-hover table-loan table-striped'>
                                <thead class='text-center'>
                                    <th class='sorting-header' (click)="sortDeposit('ACCTNO')">
                                        <div>Account No<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header' (click)="sortDeposit('ACTYPE')">
                                        <div>Actype<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header' (click)="sortDeposit('PRODUCT_CODE')">
                                        <div>Product Code<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header' (click)="sortDeposit('PRODUCT_GROUP')">
                                        <div>Product Group<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header' (click)="sortDeposit('BALANCE')">
                                        <div>Balance<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header' (click)="sortDeposit('INT_RATE')">
                                        <div>Int Rate<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header' (click)="sortDeposit('ISSUE_DATE')">
                                        <div>Issue Date<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th class='sorting-header' (click)="sortDeposit('MATURITY_DATE')">
                                        <div>Maturity Date<span class='sorting-icon'><i class="fa fa-sort"></i></span>
                                        </div>
                                    </th>
                                    <th>Relationship</th>
                                </thead>
                                <tbody>
                                    <tr *ngFor='let deposit of displayDeposits'>
                                        <td>{{deposit.ACCTNO}}</td>
                                        <td class='text-center'>{{deposit.ACTYPE}}</td>
                                        <td class='text-center'>{{deposit.PRODUCT_CODE}}</td>
                                        <td class='text-left'>{{deposit.PRODUCT_GROUP}}
                                        </td>
                                        <td class='text-right'>
                                            {{deposit.BALANCE | number : '1.2-2'}}
                                        </td>
                                        <td class='text-right'>
                                            {{deposit.INT_RATE | number : '1.2-2'}}
                                        </td>
                                        <td>{{deposit.ISSUE_DATE}}</td>
                                        <td>{{deposit.MATURITY_DATE}}</td>
                                        <td class='text-center view-product'>
                                            <button type='button' class='btn btn-success btn-view' data-toggle="modal"
                                                data-target="#accountRelModal"
                                                (click)='viewDepositRelation(deposit.ACCTNO)'>
                                                <i class="icon fa fa-search fa-1x text-white"></i>
                                                View
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- <hr> -->
<br>
<!-- Service table -->
<div class='accordion' id='accordion-service'>
    <div class='card'>
        <div class="card-header alert-warning collapsed hvr-underline-from-left" id="headingFour" data-toggle="collapse"
            data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
            <!-- <h4>Services</h4> -->
            <div class='row justify-content-between'>
                <div class='col-4'>
                    <h4>Services</h4>
                </div>
                <div class='col-1 text-right'>
                    <i class="heading-indicator icon fa fa-angle-down fa-2x"></i>
                </div>
            </div>
        </div>
        <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion-service">
            <div class="overlay" *ngIf='!accServices'>
                <div class="m-loader mr-4">
                    <svg class="m-circular" viewBox="25 25 50 50">
                        <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4"
                            stroke-miterlimit="10" />
                    </svg>
                </div>
                <h3 class="l-text">Loading</h3>
            </div>
            <div class="card-body">
                <div class='row'>
                    <div class='col-md-3 col-sm-4 col-6' *ngFor='let service of accServices'>
                        <div class="custom-control custom-checkbox">
                            <input class="custom-control-input" disabled type="checkbox"
                                [checked]='service?.AVAIL_FLAG == 1'>
                            <label class="custom-control-label">{{service.PRODUCT}}</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<br>
<!-- Account Relationship -->
<div class="modal fade" id="accountRelModal" tabindex="-1" role="dialog" aria-labelledby="accountRelModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header alert-success">
                <h5 class="modal-title" id="customerGroupLabel">Relationship</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <br>
                <div style='max-height: 65vh; overflow-y: auto;'>
                    <div class='table-responsive'>
                        <table class="table table-bordered table-hover table-striped table-loan relation">
                            <thead class='text-center'>
                                <tr>
                                    <th scope="col" class='bg-white border-left-0 border-top-0'></th>
                                    <th scope="col">CIF</th>
                                    <th scope="col">Customer Name</th>
                                    <th scope="col">Type</th>
                                    <th scope="col">Relation</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor='let rel of accRelation; index as no'>
                                    <td class='text-right'>{{no+1}}</td>
                                    <td>{{rel.CIF_KEY}}</td>
                                    <td>{{rel.CUSTOMER_NAME}}</td>
                                    <td>{{rel.TYPE_DESC}}</td>
                                    <td>{{rel.RELA_DESC}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- View Others -->
<div class="modal fade" id="othersModal" tabindex="-1" role="dialog" aria-labelledby="othersModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document" style='min-width:550px;'>
        <div class="modal-content">
            <div class="modal-header alert-secondary">
                <h5 class="modal-title" id="othersModalLabel">Others</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class='row'>
                    <div class='col-md-12'>
                        <form class='form-inline'>
                            <div class='form-group pl-5'>
                                <label class='control-label ml-5 mr-4'>Late Charge</label>
                                <input id='lateCharge' class="form-control form-control-sm text-right bg-white" readonly
                                    type="text" [value]='0 | number : "1.2-2"' style='margin-left: 25px;'>
                            </div>
                        </form>
                        <form class='form-inline'>
                            <div class='form-group pl-5'>
                                <label class='control-label ml-5 mr-4'>Misc Charge</label>
                                <input id='miscCharge' class="form-control form-control-sm text-right bg-white ml-4"
                                    readonly type="text" [value]='0 | number : "1.2-2"'>
                            </div>
                        </form>
                        <form class='form-inline'>
                            <div class='form-group pl-5'>
                                <label class='control-label ml-5 mr-5'>Provision</label>
                                <input id='provisionCharge' class="form-control form-control-sm text-right bg-white"
                                    readonly type="text" [value]='0 | number : "1.2-2"' style='margin-left: 20px;'>
                                <label id='provisionDate' class='control-label text-danger text-left'
                                    style='width:180px;justify-content: left;padding-left:10px;'></label>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- View collateral -->
<div class="modal fade" id="collateral2Modal" tabindex="-1" role="dialog" aria-labelledby="collateral2ModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document" style='max-width: 90vw;'>
        <div class="modal-content">
            <div class="modal-header alert-info">
                <h5 class="modal-title" id="collateralModal2Label">Collateral</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div id='collateral-content2' style='max-height: 65vh; overflow-y: auto;'>
                    <div class='table-responsive' *ngIf='collaterals?.length > 0'>
                        <table class="table table-loan table-bordered table-hover table-striped">
                            <thead class='text-center cursor-pointer'>
                                <tr>
                                    <th scope="col" style="font-size:14px" (click)="sortCollateral('CCDCID')">ID<span
                                            class='sorting'><i class="fa fa-sort"></i></span></th>
                                    <th scope="col" style="font-size:14px" (click)="sortCollateral('CCDNAM')">Name<span
                                            class='sorting'><i class="fa fa-sort"></i></span></th>
                                    <th scope="col" style="font-size:14px" (click)="sortCollateral('CCDDSC')">
                                        Description<span class='sorting'><i class="fa fa-sort"></i></span></th>
                                    <th scope="col" style="font-size:14px" (click)="sortCollateral('COLLATERAL_CAT')">
                                        Category<span class='sorting'><i class="fa fa-sort"></i></span></th>
                                    <th scope="col" style="font-size:14px" (click)="sortCollateral('VALUATION_DATE')">
                                        <span style='float:right'><i class="fa fa-sort"></i></span>Valuation Date</th>
                                    <th scope="col" style="font-size:14px"
                                        (click)="sortCollateral('NEXT_VALUATION_DATE')">Next Valuation Date<span
                                            style='float:right'><i class="fa fa-sort"></i></span></th>
                                    <th scope="col" style="font-size:14px" (click)="sortCollateral('CCDCMV')">
                                        Amount<span class='sorting'><i class="fa fa-sort"></i></span></th>
                                </tr>
                            </thead>
                            <tbody class='text-left'>
                                <ng-container *ngFor='let c of collaterals'>
                                    <tr class='cursor-pointer' (click)="c.expanded = !c.expanded"
                                        style='background-color:mintcream;'>
                                        <!-- <td class='text-left'><span style='font-size:18px;'>{{ c.expanded ? '&ndash;' : '+'}}</span> {{c.CCDCID}}</td> -->
                                        <td style='width:80px;'>
                                            <i *ngIf="c.DETAIL_FLAG=='Y' && !c.expanded"
                                                class="fa fa-plus-square text-primary mr-1"></i>
                                            <i *ngIf="c.DETAIL_FLAG=='Y' && c.expanded"
                                                class="fa fa-minus-square text-danger mr-1"></i>
                                            <span [ngClass]="{'pl-3': c.DETAIL_FLAG=='N'}">{{c.CCDCID}}</span></td>
                                        <td>{{c.CCDNAM}}</td>
                                        <td>{{c.CCDDSC}}</td>
                                        <td>{{c.COLLATERAL_CAT}}</td>
                                        <td>{{c.VALUATION_DATE}}</td>
                                        <td>{{c.NEXT_VALUATION_DATE}}</td>
                                        <td class='text-right'>{{c.CCDCMV | number : "1.2-2"}}</td>
                                    </tr>
                                    <ng-container *ngIf="c.expanded">
                                        <tr class='bg-white' *ngFor="let d of c.COLLATERAL_DETAILS">
                                            <td class='border-0'></td>
                                            <td class='border-0'><i class="fa fa-bookmark mr-1"></i>{{d.DISPLAY_NAME}}
                                            </td>
                                            <td colspan="3" class='border-0'>
                                                <!-- {{d.PARAM_VALUE == '' ? '-' : d.PARAM_VALUE}} -->
                                                {{d.PARAM_VALUE == '' ? '-' : d.NUMBER_FORMAT_FLAG == 'Y' ? (d.PARAM_VALUE | number : '1.2-2') : d.PARAM_VALUE}}
                                            </td>
                                        </tr>
                                    </ng-container>
                                </ng-container>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- <div class='card' *ngIf='collaterals?.length == 0'>
                    <div class='card-body p-3'>
                        <h5 class='mb-0'>This account has no collateral.</h5>
                    </div>
                </div> -->
                <div class='alert alert-dismissible alert-info w-100 mb-1' *ngIf='collaterals?.length == 0'>
                    <i class='fa fa-list-alt close'></i>
                    <h4 class='mb-1 text-left'>Not found</h4>
                    <h6>This account has no collateral.</h6>
                </div>
            </div>
            <div class="modal-footer pl-3" style='justify-content:unset;'>
                <div class='row w-100'>
                    <form class='form-inline col-12' *ngIf='totalCollateralDep > 0'>
                        <div class='form-group w-100 mb-0'>
                            <div class="input-group-prepend w-40">
                                <span class="input-group-text form-control-sm rounded-left alert-primary w-100"
                                    style='border-top-right-radius:0;border-bottom-right-radius:0;'>
                                    มูลค่าบัญชีเงินฝากรวม :
                                </span>
                            </div>
                            <input class="form-control form-control-sm rounded-right bg-white w-40 text-right" readonly
                                type="text" style='border-top-left-radius:0;border-bottom-left-radius:0;font-size:14px;'
                                [value]="totalCollateralDep | number : '1.2-2'">
                        </div>
                    </form>
                </div>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>